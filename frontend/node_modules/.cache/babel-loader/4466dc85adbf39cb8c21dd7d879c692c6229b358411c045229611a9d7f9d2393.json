{"ast":null,"code":"import React,{useEffect,useState}from'react';import{listImages}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Gallery(){const[items,setItems]=useState([]);const[page,setPage]=useState(0);const[hasMore,setHasMore]=useState(true);const[busy,setBusy]=useState(false);// eslint-disable-next-line react-hooks/exhaustive-deps\nuseEffect(()=>{load(0,true);},[]);const r2url=r2_key=>\"\".concat(process.env.REACT_APP_API_ORIGIN,\"/r2/\").concat(encodeURIComponent(r2_key));async function load(p){let reset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(busy)return;setBusy(true);try{const out=await listImages(p,24);setHasMore(out.next_page!==null&&out.next_page!==undefined);setPage(p);setItems(reset?out.items:[...items,...out.items]);}catch(e){alert('Failed to load images');}finally{setBusy(false);}}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",style:{justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Gallery\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"muted\",children:[\"Page \",page+1]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid\",style:{marginTop:12},children:items.map(it=>/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"img\",{src:r2url(it.r2_key),alt:\"\",loading:\"lazy\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta\",children:[/*#__PURE__*/_jsx(\"span\",{title:it.url,style:{overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap',maxWidth:'70%'},children:new URL(it.url).hostname}),/*#__PURE__*/_jsx(\"a\",{className:\"btn\",href:r2url(it.r2_key),target:\"_blank\",rel:\"noreferrer\",children:\"Open\"})]})]},it.id))}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:16,display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn\",disabled:busy||page===0,onClick:()=>load(page-1,true),children:\"Prev\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",disabled:busy||!hasMore,onClick:()=>load(page+1),children:\"Next\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","listImages","jsx","_jsx","jsxs","_jsxs","Gallery","items","setItems","page","setPage","hasMore","setHasMore","busy","setBusy","load","r2url","r2_key","concat","process","env","REACT_APP_API_ORIGIN","encodeURIComponent","p","reset","arguments","length","undefined","out","next_page","e","alert","className","children","style","justifyContent","marginTop","map","it","src","alt","loading","title","url","overflow","textOverflow","whiteSpace","maxWidth","URL","hostname","href","target","rel","id","display","gap","disabled","onClick"],"sources":["C:/Users/nrk82/Downloads/deepsight_osint_pro_advanced/deepsight_v2_adv/frontend/src/components/Gallery.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { listImages } from '../api';\n\nexport default function Gallery() {\n  const [items, setItems] = useState([]);\n  const [page, setPage] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n  const [busy, setBusy] = useState(false);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => {\n    load(0, true);\n  }, []);\n\n  const r2url = (r2_key) => `${process.env.REACT_APP_API_ORIGIN}/r2/${encodeURIComponent(r2_key)}`;\n\n  async function load(p, reset = false) {\n    if (busy) return;\n    setBusy(true);\n    try {\n      const out = await listImages(p, 24);\n      setHasMore(out.next_page !== null && out.next_page !== undefined);\n      setPage(p);\n      setItems(reset ? out.items : [...items, ...out.items]);\n    } catch (e) {\n      alert('Failed to load images');\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"row\" style={{ justifyContent: 'space-between' }}>\n        <h2>Gallery</h2>\n        <div className=\"muted\">Page {page + 1}</div>\n      </div>\n      <div className=\"grid\" style={{ marginTop: 12 }}>\n        {items.map((it) => (\n          <div className=\"card\" key={it.id}>\n            <img src={r2url(it.r2_key)} alt=\"\" loading=\"lazy\" />\n            <div className=\"meta\">\n              <span\n                title={it.url}\n                style={{\n                  overflow: 'hidden',\n                  textOverflow: 'ellipsis',\n                  whiteSpace: 'nowrap',\n                  maxWidth: '70%',\n                }}\n              >\n                {new URL(it.url).hostname}\n              </span>\n              <a className=\"btn\" href={r2url(it.r2_key)} target=\"_blank\" rel=\"noreferrer\">\n                Open\n              </a>\n            </div>\n          </div>\n        ))}\n      </div>\n      <div style={{ marginTop: 16, display: 'flex', gap: 8 }}>\n        <button className=\"btn\" disabled={busy || page === 0} onClick={() => load(page - 1, true)}>\n          Prev\n        </button>\n        <button className=\"btn\" disabled={busy || !hasMore} onClick={() => load(page + 1)}>\n          Next\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}